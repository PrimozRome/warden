<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Warden</title>
        <meta name="description" content="A user database authorization package for FuelPHP. Handles user login and logout, as well as secure password hashing.">
        <meta name="author" content="Andrew Wayne">

        <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
        <!--[if lt IE 9]>
          <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <link href="assets/css/bootstrap.css" rel="stylesheet">
        <link href="assets/css/docs.css" rel="stylesheet">
        <link href="assets/js/google-code-prettify/prettify.css" rel="stylesheet">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
        <script src="assets/js/google-code-prettify/prettify.js"></script>
        <script>$(function () { prettyPrint() })</script>
    </head>

    <body>

        <div class="upper-bar">&nbsp;</div>

        <header class="jumbotron masthead">
            <div class="inner">
                <div class="container">
                    <h1>Warden</h1>
                </div><!-- /container -->
            </div>
        </header>

        <div id="description">
            <p class="lead">
                Warden is a user database authorization package for FuelPHP.<br /><br />
                <a href="https://github.com/dre1080/warden" class="btn danger large">Warden on GitHub</a>
            </p>
        </div>

        <div class="container">

            <!-- Introduction
            ================================================== -->
            <section id="introduction">
                <div class="page-header">
                    <h1>Introduction</h1>
                </div>

                <div class="row">
                    <div class="span16">
                        <h3>Features</h3>
                        <ul>
                            <li>Secure BCrypt password hashing</li>
                            <li>User login</li>
                            <li>User logout</li>
                            <li>User ACL</li>
                            <li>Remember-me functionality</li>
                            <li>Reset-password functionality and many more to come</li>
                        </ul>
                    </div>
                </div>

                <div class="row">
                    <div class="span16">
                        <h3>Why use BCrypt?</h3>
                        <p>
                            If you store user passwords in the clear, then an attacker who steals a copy of your database has a giant list of emails and passwords.
                            Some of your users will only have one password &mdash; for their email account, for their banking account, for your application.
                            A simple hack could escalate into massive identity theft.
                            It's your responsibility as a web developer to make your web application secure &mdash; blaming your users for not being security experts is not a professional response to risk.
                            <em>BCrypt</em> allows you to easily harden your application against these kinds of attacks.
                        </p>
                        <p>
                            <a href="http://codahale.com/how-to-safely-store-a-password" target="_blank">http://codahale.com/how-to-safely-store-a-password</a>
                            <a href="http://yorickpeterse.com/articles/use-bcrypt-fool" target="_blank">http://yorickpeterse.com/articles/use-bcrypt-fool</a>
                        </p>
                    </div>
                </div>
            </section>

            <!-- Requirements
            ================================================== -->
            <section id="requirements">
                <div class="page-header">
                    <h1>Requirements <small>Wait! Before you start...</small></h1>
                </div>

                <div class="row">
                    <div class="span16">
                        <h3>Packages</h3>
                        <p>The following packages are needed for Warden to work:</p>
                        <ul>
                            <li><a href="https://github.com/fuel/orm">Orm</a></li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Installation
            ================================================== -->
            <section id="installation">
                <div class="page-header">
                    <h1>Installation <small>Setting it up</small></h1>
                </div>

                <div class="row">
                    <div class="span16">
                        <p>
                            This package follows standard installation rules, which can be found within the
                            <a href="http://fuelphp.com/docs/general/packages.html">FuelPHP Documentation for Packages</a>
                            You have two options you can autoload the package in your <em>app/config.php</em>:
                        </p>
                        <pre class="prettyprint lang-php">
'always_load' => array(
    'packages'  => array(
        array('warden')
    ),
) //...
                        </pre>

                        <p>or load it manually like so:</p>
                        <pre class="prettyprint lang-php">
Fuel::add_package('warden');
                        </pre>

                        <p>
                            View <a href="https://raw.github.com/dre1080/warden/master/config/install.sql"><em>config/install.sql</em></a>
                            for table structures.
                            Create your roles in the <em>roles</em> table to assign roles to users.
                        </p>
                    </div>
                </div><!-- /row -->
            </section>

            <section id="configuration">
                <div class="page-header">
                    <h1>Configuration <small>Settings &amp; things</small></h1>
                </div>

                <div class="row">
                    <div class="span16">
                        <p>
                            For now, only config options are:
                            <ul>
                                <li>(int) lifetime: The remember-me cookie lifetime, in seconds. (default: 1209600)</li>
                                <li>(string) default_role: The default role to assign a newly created user, it must already exist. (default: null)</li>
                                <li>(bool) trackable: Set to track information about user sign ins. (default: true)</li>
                                <li>
                                    recoverable: Takes care of resetting the user password.
                                    <ul>
                                        <li>(bool) in_use: Set to false, to disable. (default: true)</li>
                                        <li>(string) reset_password_within: The limit time within which the reset password token is valid. (default: '+1 week')</li>
                                    </ul>
                                </li>

                                <li>
                                    http_authenticatable: provides basic and digest authentication.
                                    <ul>
                                        <li>(bool) in_use: Set to false, to disable. (default: true)</li>
                                        <li>(string) method: The type of Http method to use for authentication. (default: 'digest')</li>
                                        <li>(string) realm: (default: 'Protected by Warden')</li>
                                        <li>(array) users: The users to permit.</li>
                                        <li>(string) failure_text: The message to display on failure.</li>
                                    </ul>
                                </li>
                            </ul>
                        </p>
                    </div>
                </div>
            </section>

            <section id="examples">
                <div class="page-header">
                    <h1>Examples <small>Brief overview &amp; usage</small></h1>
                </div>

                <div class="row">
                    <div class="span16">
                        <h3>Check for validated login</h3>
                        <pre class="prettyprint lang-php">
if (Warden::check()) {
    echo "I'm logged in :D";
} else {
    echo "Failed, I'm NOT logged in :(";
}
                        </pre>
                    </div>
                </div><!-- /row -->

                <div class="row">
                    <div class="span16">
                        <h3>Getting the currently logged in user</h3>
                        <pre class="prettyprint lang-php">
if (Warden::check()) {
    $current_user = Warden::current_user();
    echo $current_user->username;
}
                        </pre>
                    </div>
                </div><!-- /row -->

                <div class="row">
                    <div class="span16">
                        <h3>Checking for a specific role</h3>
                        <pre class="prettyprint lang-php">
if (Warden::logged_in('admin')) {
    echo "Current user logged in as an admin";
}

$user = Model_User::find(2);
if (Warden::has_access(array('editor', 'moderator'), $user)) {
    echo "Hey, editor - moderator";
} else {
    echo "Fail!";
}
                        </pre>
                    </div>
                </div><!-- /row -->

                <div class="row">
                    <div class="span16">
                        <h3>Log in a user by using a username/email and plain-text password</h3>
                        <pre class="prettyprint lang-php">
if (Input::method() === 'POST') {
    if (Warden::authenticate_user(Input::post('username_or_email'), Input::post('password'))) {
        Session::set_flash('success', 'Logged in successfully');
    } else {
        Session::set_flash('error', 'Username or password invalid');
    }
    Response::redirect();
}
                        </pre>
                    </div>
                </div><!-- /row -->

                <div class="row">
                    <div class="span16">
                        <h3>Log in a user using a http based authentication method</h3>
                        <pre class="prettyprint lang-php">
if (($user_array = Warden::http_authenticate_user())) {
    echo "Welcome {$user_array['username']}";
}
                        </pre>
                    </div>
                </div><!-- /row -->

                <div class="row">
                    <div class="span16">
                        <h3>Log out a user by removing the related session variables</h3>
                        <pre class="prettyprint lang-php">
if (Warden::logout()) {
     echo "I'm logged out";
}
                        </pre>
                    </div>
                </div><!-- /row -->

                <div class="row">
                    <div class="span16">
                        <h3>Resetting a user's password</h3>
                        <pre class="prettyprint lang-php">
// Sending the password token
$user = Model_User::find('first', array('where' => array('email' => 'myemail@warden.net')));
if (!is_null($user)) {
    if ($user->generate_reset_password_token()) {
        $token = $user->reset_password_token;
        // mail it to the user with a link
        // ...
    }
}

// Resetting the password
try {
    $user = Model_User::reset_password_by_token(\Input::get('reset_password_token'), 'new_password');

    if (!is_null($user)) {
        echo 'Success!';
    } else {
        echo 'Not a valid user';
    }
} catch (\Orm\ValidationFailed $ex) {
    // reset password token has expired
    echo $ex->getMessage();
}
                        </pre>
                    </div>
                </div><!-- /row -->
            </section>

        </div><!-- /container -->

        <footer class="footer">
            <div class="container">
                <p class="pull-right"><a href="#">Back to top</a></p>
                <p><a href="https://github.com/dre1080/warden">Warden on GitHub</a></p>
                <p>
                    By <a href="http://twitter.com/heyinspire" target="_blank">@heyinspire</a>.<br />
                    Licensed under the <a href="https://raw.github.com/dre1080/warden/master/LICENSE" target="_blank">MIT License</a>.
                </p>
            </div>
        </footer>

    </body>
</html>